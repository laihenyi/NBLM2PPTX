# NBLM2PPTX - NotebookLM PDF を PPTX に変換

[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![GitHub stars](https://img.shields.io/github/stars/laihenyi/NBLM2PPTX)](https://github.com/laihenyi/NBLM2PPTX/stargazers)
[![GitHub forks](https://img.shields.io/github/forks/laihenyi/NBLM2PPTX)](https://github.com/laihenyi/NBLM2PPTX/network/members)
[![GitHub issues](https://img.shields.io/github/issues/laihenyi/NBLM2PPTX)](https://github.com/laihenyi/NBLM2PPTX/issues)

NotebookLM からエクスポートした PDF を**背景画像とテキストが分離された** PPTX プレゼンテーションに変換します。

> ✨ **更新 (2026-01-21)**: v2.2.1 リリース - 完全な多言語リニューアル！全言語版がプロフェッショナルなライトテーマデザインになり、UX と標準化されたドキュメントが改善されました。

[English](README.md) | [繁體中文](README-zh-TW.md) | [简体中文](README-zh-CN.md) | [Español](README-es.md) | [Français](README-fr.md)

## デモ

### v1.1 - ハイブリッドテキスト抽出

| 原本 (NotebookLM PDF) | 出力 (編集可能な PPTX) |
|:---------------------:|:----------------------:|
| <img src="assets/demo-v1.1-original.jpg" width="400"> | <img src="assets/demo-v1.1-output.jpg" width="400"> |

> PDF.js ネイティブテキスト抽出により、追加の API 呼び出しなしで正確なテキスト配置を提供します。

### v1.0 - AI テキスト削除

| 変換前 (NotebookLM PDF) | 変換後 (編集可能な PPTX) |
|:-----------------------:|:------------------------:|
| <img src="assets/demo-after.png" width="400"> | <img src="assets/demo-before.png" width="400"> |

> 左：NotebookLM の元の PDF（テキストが画像に埋め込まれている）
> 右：変換後の PPTX、クリーンな背景 + 編集可能なテキストレイヤー

## v2.2.1 の新機能 (2026-01-21)

### 🌍 完全な多言語リニューアル
- **全言語のプロフェッショナルデザイン**：全言語版（英語、スペイン語、日本語、フランス語、簡体字中国語）をダークテーマからモダンなライトテーマに完全リデザイン
- **統一フォントシステム**：Poppins（見出し）+ Open Sans（本文）に移行し、言語固有のフォールバック（Noto Sans JP、Noto Sans SC など）を実装
- **プロフェッショナルなブルー配色**：全バージョンで一貫した #3B82F6 プライマリカラーを実装し、信頼性とプロフェッショナル性を向上
- **強化された API Key モーダル**：ブラウザベースの API Key ストレージと localStorage 統合により、コード編集不要
- **折りたたみ可能な UI 要素**：折りたたみ可能なアラートバナーとツールセクションを追加し、よりクリーンなインターフェース

### 📚 標準化されたドキュメント
- **包括的な README**：全言語の README ファイルが 204 行の包括的構造に統一
- **クイックスタートガイド**：より良いオンボーディングのための 3 ステップクイックスタート手順を追加
- **無料 API クォータの詳細**：Google Gemini の無料枠（15 RPM、1500 RPD、クレジットカード不要）を明確に記載
- **完全な FAQ セクション**：API キー、セキュリティ、失敗、共有、オフライン使用に関する一般的な質問をカバーする 5 つの Q&A

### 🎨 デザインシステムのアップデート
- **ライトテーマ**：読みやすさ向上のため #F8FAFC 背景
- **モダンなカードレイアウト**：クリーンなボーダー（#E2E8F0）と繊細なシャドウ
- **プロフェッショナルな SVG アイコン**：絵文字アイコンを適切な SVG グラフィックに置き換え
- **レスポンシブタイポグラフィ**：全画面サイズに最適化されたフォントサイズとスペーシング

---

## v2.2 の新機能 (2026-01-20)

### 🎯 API Key を保持するソフトリセット
- **再入力不要**：「再開」をクリックしても API Key はメモリに保持されます
- **無制限の再開**：複数のバッチを処理しても認証情報を再入力する必要がありません
- **スマートな状態管理**：すべての処理状態をリセットしながら認証情報は保持

### ⚡ 速度最適化
- **処理速度 70% 向上**：ページ間の遅延を 3.5 秒から 1.0 秒に短縮
- **並列処理**：同時 API 呼び出しを活用して最大の効率を実現
- **即座のリセット**：ソフトリセットでページリロードなしに初期状態に即座に戻ります

### 🔧 IMAGE_RECITATION エラー修正
- **改善された AI プロンプト**：著作権検出を回避するためのプロンプトエンジニアリングの最適化
- **より良い背景再構築**：より正確なコンテンツ対応塗りつぶしの結果
- **温度パラメータの低減**：温度 0.4 でより一貫性のある AI 動作

### 📝 UI 改善
- **より明確な説明**：実際のワークフローに合わせて API Key セットアップガイドを更新
- **クリーンなリセット UI**：リセット時にローディングスピナーではなく初期アップロード画面を復元

## 機能

- **AI テキスト削除**：Gemini 2.5 Flash を使用して画像からテキストを自動的に削除し、背景を再構築
- **ハイブリッドテキスト抽出**：PDF ソースは PDF.js ネイティブ抽出で正確な座標を取得；画像ソースは強化版 Gemini OCR を使用
- **レイヤー分離**：エクスポートされた PPTX には、背景画像とテキストが独立したレイヤーとして含まれ、編集が容易
- **バッチ処理**：複数の PDF ページまたは画像を一度に処理可能
- **ページ選択**：処理するページを自由に選択でき、時間と API クォータを節約

## 使用方法

### クイックスタート（3つの簡単なステップ）

1. **ブラウザで HTML ファイルを開く**（Chrome/Edge 推奨）
2. **ガイドに従ってセットアップ**し、Google から無料の API Key を取得
3. **処理を開始**して、PDF または画像をすぐに変換！

### 初回セットアップ

アプリケーションを初めて開くと、親切なセットアップウィザードが以下の手順をガイドします：

1. **Google AI Studio にアクセス** - [aistudio.google.com/apikey](https://aistudio.google.com/apikey) へのワンクリックリンク
2. **無料の API Key を作成** - Google アカウントでサインイン（クレジットカード不要）
3. **貼り付けて保存** - API Key をコピーしてアプリに貼り付け

> 🔒 **API Key はブラウザに安全に保存され**、サーバーにアップロードされることはありません。

### 無料 API クォータ

Google Gemini API は寛大な無料枠を提供しています：
- **1分あたり15リクエスト**
- **1日あたり1,500リクエスト**
- **クレジットカード不要**

これは通常の日常使用には十分すぎるほどです！

### 代替方法：Google Gemini Canvas での使用（上級者向け）

Gemini Canvas 環境で実行したい場合：

1. [Google Gemini](https://gemini.google.com/) を開く
2. `index-ja.html` のコードを Canvas に貼り付け
3. 「Preview」をクリックして実行

> ⚠️ **注意**：2026年1月現在、Canvas 環境でも API Key が必要です。アプリがセットアップを促します。

## ワークフロー

```
┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│ PDF/画像を  │ -> │  ページを   │ -> │  AI 処理    │ -> │ PPTX を     │
│ アップロード│    │   選択      │    │ テキスト削除│    │ エクスポート│
└─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘
```

### Step 1：ファイルのアップロード
- NotebookLM からエクスポートした PDF をドラッグ＆ドロップまたはクリックしてアップロード
- JPG、PNG、WebP などの画像形式もサポート
- 複数のファイルを一度にアップロード可能

> **ヒント**：NotebookLM からエクスポートした PDF はサイズが大きい場合があります。無料の PDF 圧縮サービスでファイルサイズを縮小してからアップロードすると、処理効率が向上します。

### Step 2：ページの選択
- システムが自動的にすべてのページのサムネイルを生成
- 処理するページにチェックを入れる（デフォルトですべて選択）
- 「処理開始」をクリックして次へ

### Step 3：AI 処理
- Gemini が各ページからテキストを削除し、背景を再構築
- 進捗状況がリアルタイムで表示
- 各ページ約 3-5 秒（API レイテンシを含む）

> **注意**：Gemini のテキスト削除は不完全な場合があります。テキストの残留が多い場合は、再処理をお試しください。

### Step 4：PPTX のエクスポート
- プレゼンテーションの比率を選択（16:9 / 9:16 / 4:3）
- 「PPTX エクスポート」をクリックしてダウンロード
- テキスト配置はハイブリッド戦略を使用：
  - **PDF ソース**：PDF.js で事前抽出した座標を使用（即時完了、API 不要）
  - **画像ソース**：Gemini OCR 強化版スタイル検出を使用

## 出力構造

エクスポートされた PPTX の各スライドには以下が含まれます：

| レイヤー | 内容 |
|----------|------|
| 下層 | テキストが削除されたクリーンな背景画像 |
| 上層 | 編集可能なテキストボックス（元のテキスト位置に配置） |

このレイヤー構造により：
- テキスト内容を簡単に編集
- フォント、色、サイズの変更
- テキスト位置の調整
- 元のデザインスタイルの保持

## 技術仕様

| 項目 | 説明 |
|------|------|
| AI モデル | Gemini 2.5 Flash Image（テキスト削除）+ Gemini 2.5 Flash（OCR）|
| テキスト削除 | 完全な削除と背景修復のための最適化プロンプト |
| PDF 解析 | PDF.js 3.11.174 |
| PPTX 生成 | PptxGenJS 3.12.0 |
| レンダリング解像度 | サムネイル 0.5x / 処理 2.0x |
| サポート形式 | PDF, JPG, PNG, WebP, BMP |
| テキスト抽出 | ハイブリッド：PDF.js ネイティブ（PDF）/ Gemini OCR（画像）|

## 注意事項

1. **API クォータ**：テキスト削除は Gemini API を使用；PDF テキスト抽出はローカル処理（API コストなし）
2. **レート制限**：429 エラーが発生した場合、システムは自動的に待機して再試行
3. **処理時間**：大量のページがある場合はバッチ処理を推奨
4. **ネットワーク**：安定したインターネット接続が必要
5. **ブラウザ**：Chrome または Edge（最新バージョン）を推奨
6. **PDF の利点**：PDF ソースはエクスポートが高速で、テキスト配置がより正確

## よくある質問

### Q: API Key を取得するにはクレジットカードが必要ですか？
A: いいえ！Google Gemini API は完全に無料の枠を提供しており、クレジットカードは不要です。Google アカウントでサインインするだけです。

### Q: API Key は安全ですか？
A: はい！API Key はブラウザの localStorage にのみ保存され、Google の公式 Gemini API 以外のサーバーに送信されることはありません。

### Q: 処理が失敗した場合は？
A: よくある原因：
- API Key が無効（「AIza」で始まっているか確認）
- ネットワーク接続が不安定
- 画像が大きすぎるまたはサポートされていない形式
- API レート制限を超過（無料枠：15/分、1500/日 - 待機後に再試行）

### Q: このツールを他の人と共有できますか？
A: もちろんです！HTML ファイルを共有するだけです。各ユーザーは自分の API Key を設定するため、全員が自分の無料クォータを持ちます。

### Q: オフラインで使用できますか？
A: いいえ、このツールは AI 処理のために Gemini API 呼び出しが必要です。

## 言語バージョン

| 言語 | ファイル |
|------|----------|
| 繁體中文 | `index.html` |
| English | `index-en.html` |
| Español | `index-es.html` |
| 日本語 | `index-ja.html` |
| Français | `index-fr.html` |
| 简体中文 | `index-zh-CN.html` |

## License

MIT License
